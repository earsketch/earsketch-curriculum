# 'Atlanta Song of Summer' Qo'shig'i: Butun qo'shiqni abstraktsiyalar bilan yaratish
# qo'shiqning tarkibi: kirish-A-B-A-B

from earsketch import *
setTempo(110)

# Tovush o'zgaruvchilari
melody1 = EIGHT_BIT_ATARI_BASSLINE_005
melody2 = DUBSTEP_LEAD_018
melody3 = DUBSTEP_LEAD_017
melody4 = DUBSTEP_LEAD_013
bass1 = HIPHOP_BASSSUB_001
bass2 = RD_TRAP_BASSDROPS_2
brass1 = Y30_BRASS_4
shout = CIARA_SET_TALK_ADLIB_AH_4
piano = YG_RNB_PIANO_4
kick = OS_KICK02
hihat = OS_CLOSEDHAT03

// FUNKTSIYALAR TA'RIFI

#Barabanlarni qo'shish:
def addingDrums(start, end, pattern):
    # avval biz parametrlar andozasiga ko'ra zarba satrlarini yaratamiz:
    if pattern == "heavy":
        beatStringKick = "0---0---0---00--"
        beatStringHihat = "-----000----0-00"
    elif pattern == "light":
        beatStringKick = "0-------0---0---"
        beatStringHihat = "--0----0---0---"
    # kegin zarbani yaratamiz
    # 3-trekda kick degan zarbani va 4-trekda hihat degan zarbani
    # start nomli o'lchamdan end nomli o'lchamgacha:
    for measure in range(start, end):
        # bu yerda zarbamizni "measure" ga qo'yamiz,
        # avval u "start" qiymatiga ega,
        # va u funktsiyaning bir parametri
        makeBeat(kick, 3, measure, beatStringKick)
        makeBeat(hihat, 4, measure, beatStringHihat)

# Kirish:
def intro(start, end):
    fitMedia(melody1, 1, start, start + 1)
    fitMedia(melody1, 1, start + 2, start + 3)
    fitMedia(bass1, 2, start, start + 3)
    # o'tish:
    fitMedia(bass2, 2, start + 3, end)
    fitMedia(shout, 3, start + 3.75, end)

# A qismi:
def sectionA(start, end):
    fitMedia(melody2, 1, start, end)
    fitMedia(brass1, 2, start, end)
    setEffect(2, VOLUME, GAIN, -20, start, -10, end)
    addingDrums(start, end, "heavy")
    # O'tish uchun tovushni modulyatsiya qilish:
    setEffect(1, BANDPASS, BANDPASS_FREQ, 200, end - 2, 1000, end)

# B qismi:
def sectionB(start, end):
    fitMedia(melody3, 1, start, start + 2)
    fitMedia(melody4, 1, start + 2, end)
    fitMedia(piano, 2, start, end)
    addingDrums(start, end, "light")

# FUNKTSIYALARNI CHAQIRISH
intro(1, 5)
sectionA(5, 9)
sectionB(9, 13)
sectionA(13, 17)
sectionB(17, 21)

# Ovoz pasayib tugatish:
for track in range(1, 5):
    setEffect(track, VOLUME, GAIN, 0, 19, -60, 21)
# Hihat va kick zarbalarning ovozini pasaytirish:
setEffect(4, VOLUME, GAIN, -15)
setEffect(3, VOLUME, GAIN, -10)