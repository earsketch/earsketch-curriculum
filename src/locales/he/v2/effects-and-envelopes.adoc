[[effectsandenvelopes]]
== אפקטים ומעטפות
:nofooter:

EarSketch מאפשרת ליוצר/ת לשנות קליפים וליצור צלילים חדשים וייחודיים. זה נעשה בעזרת הפונקציה`()setEffect`, בה נתמקד בפרק זה.

[[effectsinearsketch]]
=== שימוש באפקטים ב-EarSketch

*אפקטים* מאפשרים לשנות איכויות של צלילים. בדומה לאופן בו פילטרים משנים תמונה, הוספת אפקט משנה את הצליל. אפשר לשנות את העוצמה של הצליל ולהוסיף לו הד, למשל...

[role="curriculum-python curriculum-mp4"]
[[video4py]]
video::./videoMedia/004-01-UsingEffectsinEarSketch-PY.mp4[]

[role="curriculum-javascript curriculum-mp4"]
[[video4js]]
video::./videoMedia/004-01-UsingEffectsinEarSketch-JS.mp4[]

נשתמש בפונקציה`()setEffect`, שמקבלת ארבעה פרמטרים, בדומה לפונקציה`()fitMedia`:

. *trackNumber*: הערוץ אליו יתווסף האפקט.
. *effectName*: האפקט עצמו.
. *effectParameter*: הפרמטר של האפקט.
. *effectValue*: הערך של הפרמטר: מספר בטווח ספציפי. הטווח תלוי בפרמטר של האפקט.

.תרגלו
****
כתבו שיר בשני ערוצים ושנו את העוצמה (ווליום) של שני הערוצים בעזרת הפונקציה `()setEffect`. 
במקרה זה, שם האפקט (הפרמטר השני) הוא VOLUME, והפרמטר של האפקט (הפרמטר השלישי) הוא GAIN. הערך של האפקט (הפרמטר הרביעי) הוא מספר של דציבלים (dB) בין 60- ל-12+. 
****

הנה דוגמה:

[role="curriculum-python"]
[source,python]
----
# Volume Effect: Modifying the volume of 2 tracks

# Setup
from earsketch import *
setTempo(120)

# Variables
piano1 = COMMON_LOVE_THEME_PIANO_2
percussions1 = HOUSE_BREAK_FILL_002

# Placing the sounds:
fitMedia(piano1, 1, 1, 5)
fitMedia(percussions1, 2, 3, 5)

# Mixing: increase the piano track and reduce the percussion track volumes
setEffect(1, VOLUME, GAIN, 2)
setEffect(2, VOLUME, GAIN, -15)
----

[role="curriculum-javascript"]
[source,javascript]
----
// Volume Effect: Modifying the volume of 2 tracks

// Setup
setTempo(120);

// Variables
var piano1 = COMMON_LOVE_THEME_PIANO_2;
var percussions1 = HOUSE_BREAK_FILL_002;

// Placing the sounds
fitMedia(piano1, 1, 1, 5);
fitMedia(percussions1, 2, 3, 5);

// Mixing: increase the piano track and reduce the percussion track volumes
setEffect(1, VOLUME, GAIN, 2);
setEffect(2, VOLUME, GAIN, -15);
----

דנו באפקט`VOLUME`. כעת נדון באפקט `DELAY`. האזינו לשני הקליפים הבאים. הראשון ללא האפקט, והשני עם האפקט *delay*.

ללא אפקט:
++++
<div class="curriculum-mp3">audioMedia/reference.mp3</div>
++++

עם אפקט delay:
++++
<div class="curriculum-mp3">audioMedia/delay2.mp3</div>
++++

במקרה זה, שם האפקט (הפרמטר השני) הוא `DELAY`, והפרמטר של האפקט (הפרמטר השלישי) יכול להיות או `DELAY_TIME` (אורך הזמן לפני שההד "עונה") או `DELAY_FEEDBACK` (עוצמת ההד). הערך של `DELAY_TIME` הוא במילישניות (1000 מילישניות הן שניה אחת) והערך של`DELAY_FEEDBACK` הוא מספר בין 120- ו-1-.

.תרגלו
****
. Read about the delay effect in the list of effects chapter here: <</en/v1/every-effect-explained-in-detail#, effects>>
. הריצו את הקוד שמופיע בהמשך והקשיבו למוסיקה ללא אפקטים
. הפכו ללא הערה את שורת `()setEffect` הראשונה והקשיבו להבדל
. הפכו ללא הערה את שורת `()setEffect` השנייה והקשיבו להבדל (להפוך שורה ללא הערה פירושו למחוק מתחילת השורה את `#` או`//` ).
שימו לב לכך שזמן ההשהיה (הפרמטר הרביעי) הוא 500mS, שהוא אורך של ביט (פעמה) אחד. מכיוון שהטמפו הוא 120bpm, יש ביט כל חצי שניה (1/2=60/120). שנייה אחת היא 1000 מילישניות, וחצי שנייה היא 500 מילישניות.
שנו את זמן ההשהיה. האם המוסיקה נשמעת טוב יותר או לא?
****

[role="curriculum-python"]
[source,python]
----
# Delay Effect: Adding delay to a track

# Setup
from earsketch import *
setTempo(120)

# Music
lead1 = EIGHT_BIT_ATARI_SYNTH_001
lead2 = EIGHT_BIT_ATARI_SYNTH_002
pad1 = EIGHT_BIT_ATARI_PAD_002
pad2 = EIGHT_BIT_ATARI_PAD_003
drums1 = EIGHT_BIT_ANALOG_DRUM_LOOP_004
drums2 = EIGHT_BIT_ANALOG_DRUM_LOOP_003

fitMedia(lead1, 1, 1, 7)
fitMedia(lead2, 1, 7, 9)

fitMedia(pad1, 2, 1, 3)
fitMedia(pad2, 2, 3, 5)
fitMedia(pad1, 2, 5, 7)
fitMedia(pad2, 2, 7, 9)

fitMedia(drums1, 3, 3, 5)
fitMedia(drums2, 3, 5, 9)

# Effects
# setEffect(1, DELAY, DELAY_TIME, 500)  # Adds a delay (echo) effect at intervals of 500ms.
# setEffect(1, DELAY, DELAY_FEEDBACK, -20.0)  # Lowers the relative amount of repeats (default is -3.0).
----

[role="curriculum-javascript"]
[source,javascript]
----
// Delay Effect: Adding delay to a track

// Setup
setTempo(120);

// Music
var lead1 = EIGHT_BIT_ATARI_SYNTH_001;
var lead2 = EIGHT_BIT_ATARI_SYNTH_002;
var pad1 = EIGHT_BIT_ATARI_PAD_002;
var pad2 = EIGHT_BIT_ATARI_PAD_003;
var drums1 = EIGHT_BIT_ANALOG_DRUM_LOOP_004;
var drums2 = EIGHT_BIT_ANALOG_DRUM_LOOP_003;

fitMedia(lead1, 1, 1, 7);
fitMedia(lead2, 1, 7, 9);
fitMedia(pad1, 2, 1, 3);
fitMedia(pad2, 2, 3, 5);
fitMedia(pad1, 2, 5, 7);
fitMedia(pad2, 2, 7, 9);
fitMedia(drums1, 3, 3, 5);
fitMedia(drums2, 3, 5, 9);

// Effects
// setEffect(1, DELAY, DELAY_TIME, 500); // Adds a delay (echo) effect at intervals of 500ms
// setEffect(1, DELAY, DELAY_FEEDBACK, -20.0); // Lowers the relative amount of repeats (default is -3.0)
----

[[functionsandmoreeffects]]
=== פונקציות ועוד אפקטים

 עד עתה, השתמשנו במספר פונקציות ב-EarSketch כמו `()fitMedia` או `()setEffect`. שימו לב לכך, ששם של פונקציה תמיד מתחיל באות קטנה, והוא, לרוב, פועל. הסוגריים מורות למחשב *לקרוא* לפונקציה או *לבצע* אותה. *פרמטרים* (שלפעמים נקראים גם ארגומנטים), בתוך הסוגריים, מופרדים על-ידי פסיקים.

[role="curriculum-python"]
* לפונקציות `setTempo()`, `fitMedia()`, `makeBeat()`ו-`setEffect()` יש פרמטרים. הן חלק מה-<strong>Application Programming Interface - ממשק לתכנות 
 אפליקציות </strong>, או, בקיצור, ה-*API*. ה-API של EarSketch מוסיף יכולות מוסיקליות לפייתון. דוגמה נוספת ל-API הוא ה-API של Googie Maps: אוסף כלים לשיבוץ מפות באתרים או יישומים.
* בפרק מאוחר יותר נלמד איך ליצור פונקציות נוספות, המותאמות לצרכינו.

[role="curriculum-javascript"]
* לפונקציות `setTempo()`, `fitMedia()`, `makeBeat()`ו-`setEffect()` יש פרמטרים. הן חלק מה-<strong>Application Programming Interface - ממשק לתכנות 
 אפליקציות </strong>, או, בקיצור, ה-*API*. ה-API של EarSketch מוסיף יכולות מוסיקליות ל-JavaScript. דוגמה נוספת ל-API הוא ה-API של Googie Maps: אוסף כלים לשיבוץ מפות באתרים או יישומים.
* בפרק מאוחר יותר נלמד איך ליצור פונקציות נוספות, המותאמות לצרכינו.

כל פרמטר של פונקציה יכול להיות מטיפוס נתונים שונה. סדר הפרמטרים חשוב. הנה מספר דוגמאות לטיפוסי נתונים:

* *מספרים*. *מספרים שלמים או Integers* (או int) הם מספרים שלמים כמו 0, 5 או 26-. *Floating point* הם מספרים ממשיים כמו 0.125 או 21.0-. לדוגמה, הפרמטרים מספר הערוץ, תיבת ההתחלה ותיבת הסיום, בפונקציה `()fitMedia` הם כולם מספרים.
* * מחרוזות Strings*. מחרוזת תיפוף כמו `"----0000----0000"`, משמשת כפרמטר לפונקציה`()makeBeat`.

בואו נמשיך לשחק עם הפונקציה `()setEffect`. קטע הווידאו הבא מראה כיצד להשתמש במספר אפקטים:

////
VIDEO IS BEEING MADE
more info here: https://docs.google.com/spreadsheets/d/114pWGd27OkNC37ZRCZDIvoNPuwGLcO8KM5Z_sTjpn0M/edit#gid=302140020
("videos revamping" tab)
////

* Reverb (הדהוד)* הוא צליל שחוזר מהקירות אל האוזניים. הוא נותן תחושה של מרחב לצליל. חשבו על ההבדל בין דיבור בחדר קטן לדיבור בחלל של אולם גדול. ככל שהחדר גדול יותר, לוקח לצליל יותר זמן לחזור מהקירות לאוזניכם/ן, ונוצר הצליל המהדהד של אולם גדול. לאפקט `REVERB` יש פרמטרים לשליטה בזמן הדעיכה (`REVERB_DECAY`) ועצמת האפקט (`MIX`).

הקשיבו לקליפים הבאים, ושמעו את התוצאה של הוספת reverb לערוץ:

ללא אפקט:
++++
<div class="curriculum-mp3">audioMedia/reverbReferance.mp3</div>
++++

עם אפקט reverb:
++++
<div class="curriculum-mp3">audioMedia/reverbEffect.mp3</div>
++++

.תרגלו
****
Go to this chapter for a complete list of effects: <</en/v1/every-effect-explained-in-detail#, effects>>.
צרו שיר עם אפקט ווליום (volume) ושני אפקטים נוספים. אל תשכחו לתאר, בהערות, מה הקוד עושה ולהשתמש במשתנים, כשצריך.
****


[[effectsandenvelopes]]
=== אפקטים ומעטפות

לפעמים, נרצה שאפקט ישתנה בזמן. לדוגמה, נרצה שעצמת הצליל תלך ותגדל (fade in) בתחילת השיר.

* מעטפות או envelopes* מאפשרות להגדיר כיצד ישתנה האפקט לאורך זמן. 

נשתמש בשני זוגות של ערך וזמן. כל זוג כולל ערך של אפקט ותיבה מתאימה. לדוגמה, המשמעות של (3 ,0 ,1 ,60-) היא שנקודה אחת בעלת ערך 60- תמוקם בתיבה הראשונה, ושנקודה שנייה בעלת ערך 0 תמוקם בתיבה השלישית. המעטפת יוצרת קו בין שתי נקודות אלה, שנקרא *ramp או רמפה*:

[[envelopepoints]]
.מעטפת (עם הערות) ב-EarSketch
[caption="Figure 5.1: "]
image::../media/U2/NewEnvelope.png[Alt Text]

הגדרת המעטפת נעשית בפונקציה`()setEffect`שיש לה שבעה פרמטרים. ארבעת הפרמטרים האחרונים הם שני הזוגות של ערך וזמן.

. trackNumber
. effectName
. effectParameter
. effectStartValue
. effectStartLocation
. effectEndValue
. effectEndLocation

שלושת הפרמטרים האחרונים הם *פרמטרים אופציונליים*. אם לא נקבע את ערכם, כפי שעשינו כשהשתמשנו ב-`setEffect()` עם ארבעה פרמטרים, האפקט יופעל על כל הערוץ.

הנה דוגמה של fade in:

[role="curriculum-python"]
[source,python]
----
# Envelopes: Making envelopes with 7-parameter setEffect()

# Setup
from earsketch import *
setTempo(120)

# Music
fitMedia(ELECTRO_ANALOGUE_LEAD_012, 1, 1, 9)

# Makes an effect ramp between measures 1 and 3, moving from -60dB to 0dB.
# This is a fade in
setEffect(1, VOLUME, GAIN, -60, 1, 0, 3)
----

[role="curriculum-javascript"]
[source,javascript]
----
// Envelopes: Making envelopes with 7-parameter setEffect()

// Setup
setTempo(120);

// Music
fitMedia(ELECTRO_ANALOGUE_LEAD_012, 1, 1, 9);

// Makes an effect ramp between measures 1 and 3, moving from -60dB to 0dB.
// This is a fade in
setEffect(1, VOLUME, GAIN, -60, 1, 0, 3);
----

צפו בסרטון הבא המדגים מעטפות נוספות

[role="curriculum-python curriculum-mp4"]
[[video5b]]
video::./videoMedia/005-03-MoreEffectsB-PY.mp4[]


[role="curriculum-python"]
[source,python]
----
# Complex Envelopes: Using multiple setEffect() calls on a track to make changes in the effect envelope

# Setup
from earsketch import *
setTempo(120)

# Music
fitMedia(ELECTRO_ANALOGUE_LEAD_012, 1, 1, 9)

# Envelope time points (in measures)
pointA = 1
pointB = 4
pointC = 6.5
pointD = 7
pointE = 8.5
pointF = 9

setEffect(1, FILTER, FILTER_FREQ, 20, pointA, 10000, pointB)  # First effect, filter sweep

# Second effect, volume changes
setEffect(1, VOLUME, GAIN, -10, pointB, 0, pointC)  # Crescendo
setEffect(1, VOLUME, GAIN, 0, pointD, -10, pointE)  # Begin fade out
setEffect(1, VOLUME, GAIN, -10, pointE, -60, pointF)  # End of fade out
----


[role="curriculum-javascript curriculum-mp4"]
video::./videoMedia/005-03-MoreEffectsB-JS.mp4[]

[role="curriculum-javascript"]
[source,javascript]
----
// Complex Envelopes: Using multiple setEffect() calls on a track to make changes in the effect envelope

// Setup
setTempo(120);

// Music
fitMedia(ELECTRO_ANALOGUE_LEAD_012, 1, 1, 9);

// Envelope time points (in measures)
var pointA = 1;
var pointB = 4;
var pointC = 6.5;
var pointD = 7;
var pointE = 8.5;
var pointF = 9;

setEffect(1, FILTER, FILTER_FREQ, 20, pointA, 10000, pointB); // First effect, filter sweep

// Second effect, volume changes
setEffect(1, VOLUME, GAIN, -10, pointB, 0, pointC); // Crescendo
setEffect(1, VOLUME, GAIN, 0, pointD, -10, pointE); // Begin fade out
setEffect(1, VOLUME, GAIN, -10, pointE, -60, pointF); // End of fade out
----

.תרגלו
****
צרו שיר חדש. השתמשו בלולאת for כדי להוסיף מעטפת לכל הערוצים (למשל, fade in ו-fade out לכל הערוצים), או כדי לחזור על אפקט באותו ערוץ. השתמשו באיזה אפקט שתרצו. 
השמיעו את השיר לחבר/ה, עם ובלי האפקט (כדי "לבטל" את האפקט, הפכו את השורות בקוד שמגדירות את האפקט להערות). על החבר/ה לנחש מהו האפקט.
****

למטה ישנה דוגמה. כל איטרציה של הלולאה מוסיפה קטע באורך של תיבה אחת של המעטפת. השינוי האוטומטי של הפרמטר GAIN, יוצר דעיכות ריתמיות בעוצמה. זהו אפקט פופולרי ב-EDM, המודגם בשיר https://www.youtube.com/watch?v=Us_U-d2YN5Y[Rhythm] של Lvly. נסו לכבות ולהפעיל את האפקט ב-DAW כדי לשמוע את השפעת האפקט (בעזרת כפתור "bypass" משמאל לערוץ האפקט ב-DAW).


[role="curriculum-python"]
[source,python]
----
# Rhythmic Ramps: Automating effects with a for-loop

# Setup
from earsketch import *
setTempo(120)

# Music
fitMedia(Y33_CHOIR_1, 1, 1, 9)
fitMedia(RD_ELECTRO_MAINBEAT_5, 2, 1, 9)

for measure in range(1, 9):
    setEffect(1, VOLUME, GAIN, -60, measure, 0, measure + 1)
----

[role="curriculum-javascript"]
[source,javascript]
----
// Rhythmic Ramps: Automating effects with a for-loop

// Setup
setTempo(120);

// Music
fitMedia(Y33_CHOIR_1, 1, 1, 9);
fitMedia(RD_ELECTRO_MAINBEAT_5, 2, 1, 9);

for (var measure = 1; measure < 9; measure++) {
    setEffect(1, VOLUME, GAIN, -60, measure, 0, measure + 1);
}
----

And here is an example of fade in and fade out on all the tracks:

[role="curriculum-python"]
[source,python]
----
# Fade in and fade out: Looping on all tracks to add a fade in and fade out

# Setup
from earsketch import *
setTempo(100)

# Variables
melody1 = MILKNSIZZ_ADIOS_BRASS
melody2 = MILKNSIZZ_ADIOS_STRINGS
kick = OS_KICK04
hihat = OS_OPENHAT03
kickBeat = "0-------0-0-0---"
hihatBeat = "---0---0--00----"

# Placing melodies on track 1
fitMedia(melody1, 1, 1, 5)
fitMedia(melody2, 1, 5, 9)

# Placing the beats on tracks 2 (kick) and 3 (hihat) thanks to a for loop on measure
for measure in range(1, 9):
    makeBeat(kick, 2, measure, kickBeat)
    makeBeat(hihat, 3, measure, hihatBeat)

# Adding the fade in and fade out on tracks 1 through 3
for track in range(1, 4):
    setEffect(track, VOLUME, GAIN, -60, 1, 0, 3)
    setEffect(track, VOLUME, GAIN, 0, 7, -60, 9)
----
[role="curriculum-javascript"]
[source,javascript]
----
// Fade in and fade out: Looping on all tracks to add a fade in and fade out

// Setup
setTempo(100);

// Variables
var melody1 = MILKNSIZZ_ADIOS_BRASS;
var melody2 = MILKNSIZZ_ADIOS_STRINGS;
var kick = OS_KICK04;
var hihat = OS_OPENHAT03;
var kickBeat = "0-------0-0-0---";
var hihatBeat = "---0---0--00----";

// Placing melodies on track 1
fitMedia(melody1, 1, 1, 5);
fitMedia(melody2, 1, 5, 9);

// Placing the beats on tracks 2 (kick) and 3 (hihat) thanks to a for loop on measure
for (var measure = 1; measure < 9; measure++) {
    makeBeat(kick, 2, measure, kickBeat);
    makeBeat(hihat, 3, measure, hihatBeat);
}

// Adding the fade in and fade out on tracks 1 through 3
for (var track = 1; track < 4; track++) {
    setEffect(track, VOLUME, GAIN, -60, 1, 0, 3);
    setEffect(track, VOLUME, GAIN, 0, 7, -60, 9);
}
----


[[chapter5summary]]
=== סיכום פרק חמישי

* *אפקטים* משנים את איכויות הצליל, והופכים את הצליל לייחודי.
* *Volume* משנה את עצמת הקול. *Delay* יוצר הד. *Reverb* גורם לצליל להישמע כאילו הוא מנוגן בחלל של אולם גדול. *Panning* ממקם את הצליל בצד ימין או בצד שמאל.
* אפקטים מופעלים ב-EarSketch בעזרת הפונקציה `()setEffect`. התחביר שלה הוא: `setEffect(trackNumber, effectName, effectParameter, effectValue)`.
** *trackNumber*: הערוץ אליו יתווסף האפקט.
** *effectName*: האפקט עצמו.
** *effectParameter*: הפרמטר של האפקט.
** *effectValue*: הערך של הפרמטר: מספר בטווח ספציפי.
* *פונקציות* מכילות הוראות שעל המחשב לבצע. נתונים מועברים לפונקציה ב-*פרמטרים*, שמשפיעים על אופן ביצוע הפונקציה. התחביר של *קריאה* לפונקציה בעלת שני פרמטרים הוא: `myFunction(argument1, argument2)`. דוגמה לתחביר של *קריאה* לפונקציה בעלת ארבעה פרמטרים היא: `makeBeat(kick, 2, measure, kickBeat)`.
* A complete list of EarSketch effects and their parameters can be found in <</en/v1/every-effect-explained-in-detail#, effects>>, along with descriptions for each.
* *מעטפות* מגדירות את האופן בו האפקט משתנה בזמן. הן מוגדרות בעזרת צמדים של ערך-זמן, כמו _(ערך, זמן, ערך, זמן)_.
* להגדרת מעטפת, שבעת הפרמטרים של `()setEffect` הם: `setEffect(trackNumber, effectName, effectParameter, startEffectValue, effectStartLocation, endEffectValue, effectEndLocation)`.


[[chapter-questions]]
=== שאלות

[question]
--
מה אפקט מאפשר לעשות ב-EarSketch?
[answers]
* שינוי האיכויות של צליל בפרויקט
* הוספת צליל לערוץ
* שינוי ביט תיפוף
* שינוי הטמפו של ערוץ
--

[question]
--
מי מהבאים אינו פרמטר של `()setEffect`?
[answers]
* Clip Name
* Effect Name
* Effect Value
* Track Number
--

[question]
--
כיצד ניתן לקבוע את זמן ההשהיה (delay time) של אפקט delay, בערוץ השלישי, ל-50 מילישניות?
[answers]
* `setEffect(3, DELAY, DELAY_TIME, 50.0)`
* `setEffect(DELAY, 3, DELAY_TIME, 50.0)`
* `fitMedia(DELAY, 3, DELAY_TIME, 50.0)`
* `setEffect(50, DELAY_FEEDBACK, 1)`
--

[question]
--
מי מהבאים אינו פרמטר המשמש להגדרת מעטפת בעזרת הפונקציה `()setEffect`?
[answers]
* Clip Length
* Start Value
* Track Number
* Effect
--

[question]
--
מה עושה הפונקציה `()setEffect`הבאה?
[source,python]
----
setEffect(1, DISTORTION, DISTO_GAIN, 0, 1, 50, 10)
----
[answers]
* מגדילה את כמות הדיסטורשן בערוץ הראשון לאורך 10 תיבות.
* מקטינה את כמות הדיסטורשן בערוץ הראשון לאורך 50 תיבות.
* מגבירה את הווליום של הערוץ הראשון לאורך 10 תיבות.
* מחלישה את הווליום של הערוץ הראשון לאורך 50 תיבות.
--
