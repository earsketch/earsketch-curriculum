[[loopandlayers]]
== לולאות ושכבות

:nofooter:

In this chapter you will learn about `for` loops and how you can create repetition in your code and music. כמו כן, נדבר על שכבות ומרקמים, ונראה מספר טיפים לתיקון שגיאות (debugging).

[[forloops]]
=== `for` loops

Just like musicians can play a pattern again and again in a *loop*, programmers can ask the computer to complete tasks again and again... in a *loop*! This is more concise: instead of writing an instruction many times, you write one loop with the instructions, and the computer knows to repeat them.

For example, if you want to repeat a `makeBeat()` that you have created, instead of writing down several lines of `makeBeat()` functions, you can create a `for` loop.

////
add new video
more info here https://docs.google.com/spreadsheets/d/114pWGd27OkNC37ZRCZDIvoNPuwGLcO8KM5Z_sTjpn0M/edit#gid=0
in the "revamping videos" tab (includes link to script)
////

[role="curriculum-python"]
[source,python]
----
include::code-examples/loops-and-layers-looping-my-beats.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/loops-and-layers-looping-my-beats.js.txt[]
----

[role="curriculum-python"]
`for` loops in Python consist of 3 basic parts:

[role="curriculum-javascript"]
`for` loops in JavaScript consist of 4 basic parts:

[[loop-components-PY]]
.המרכיבים הבסיסיים של לולאת for
[role="curriculum-python"]
[caption="Figure 4.1.1: "]
image::../media/U1P2/Loop_Components_PY.png[Alt Text]

[[loop-components-JS]]
.המרכיבים הבסיסיים של לולאת for
[role="curriculum-javascript"]
[caption="Figure 4.1.1: "]
image::../media/U1P2/Loop_Components_JS.png[Alt Text]

[role="curriculum-python"]
* *Loop Counter*: Creates a variable to be used as a loop counter. You can have more than one line of instructions inside the `for` loop.
* *Range*: A function that makes a list of numbers for the loop counter to count through. The keyword `in` connects the loop counter to the range. `range()` takes two arguments, a starting point (inclusive) and ending point (exclusive): `range(startingNumber, endingNumber)`.
* *Loop Body*: The body of a loop contains statements that will execute repeatedly. It includes everything that is *indented* (using the _tab_ key) directly after the colon `:`.

[role="curriculum-javascript"]
* *Initialization*: This creates a variable to be used as a *loop counter* before the first loop runs.
* *Loop Condition*: This checks whether the loop should run again. אם התנאי מתקיים, גוף הלולאה יבוצע. אם המונה גדול מדי, תנאי הלולאה לא יתקיים, והלולאה תסתיים. המחשב ימשיך לבצע את ההוראה הבאה אחרי הלולאה.
* *Iteration Statement*: A statement that updates the loop counter. It counts up each time the loop repeats.
* *Loop Body*: The body of a loop contains statements that will execute repeatedly. It is surrounded by curly braces `{ }` and is *indented* (using the _tab_ key). You can have more than one line of instructions inside the `for` loop.

.תרגלו
****
. Create a `for` loop with the counter `measure` to have your `makeBeat()` from measures `1` to `4`
. Modify your code to go from measures `3` to `7`
. Then modify your code to have your beats on track `2` instead of track `1`, still from measures `3` to `7`
. Then modify your counter name, pick a track and measures, and create the appropriate `for` loop
. Show your neighbor your last `for` loop, and have them find which track your beat is on, which measures it's going to be on, and what your counter's name is.
****

{nbsp} +

[[printstatements]]
=== Print statements

To better understand the flow of your code, you can use `print()`. היא מאפשרת להציג מידע בקונסול (console), כשהקוד רץ.

[role="curriculum-python"]
When use provide data to `print()`, it is *evaluated*, or simplified it to its basic form.

[role="curriculum-javascript"]
When use provide data to `println()`, it is *evaluated*, or simplified it to its basic form.

Then the data is converted into text and shown in the console.

[role="curriculum-python"]
.תרגלו
****
Before running the following code, try to guess what the console will display for each `print()` call.
****

[role="curriculum-javascript"]
.תרגלו
****
Before running the following code, try to guess what the console will display for each `println()` call.
****

{nbsp} +

[role="curriculum-python"]
[source,python]
----
include::code-examples/loops-and-layers-printing.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/loops-and-layers-printing.js.txt[]
----

הסבר למה שיוצג בקונסול:

----
4 (this is 1+3, simplified)
1 (initially your counter measure is equal to 1)
ok
2 (now your counter measure is equal to 2)
ok (every time we go through one loop, we print "ok", that's why it's repeated)
3
ok
4
ok
----

הריצה מסתיימת כאן כי ערכו של מונה התיבות measure חייב להיות קטן מחמש.

[[controlflow]]
=== בקרת זרימה

Here is another example of how you can use `for` loops:

[role="curriculum-python curriculum-mp4"]
[[video12bpy]]
video::./videoMedia/012-03-ExampleLoop-PY.mp4[]

[role="curriculum-javascript curriculum-mp4"]
[[video12bjs]]
video::./videoMedia/012-03-ExampleLoop-JS.mp4[]

We can create repetition in our music by typing `fitMedia()` again and again, with different measure numbers:

[role="curriculum-python"]
[source,python]
----
include::code-examples/loops-and-layers-no-loops.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/loops-and-layers-no-loops.js.txt[]
----

We can use a `for` loop to create the exact same music with less code. Our counter here is `measure`. Note that the body of the loop contains two lines of code, both of which use the counter `measure`.

[role="curriculum-python"]
[source,python]
----
include::code-examples/loops-and-layers-loops.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/loops-and-layers-loops.js.txt[]
----

The *interpreter* reads and executes a script. The order it is executed in is called the *control flow*. בדרך כלל המתרגם עובר שורה שורה, מלמעלה למטה. לכן צריך להגדיר משתנים לפני שמשתמשים בהם בקוד.

A loop is a *control flow statement*, which changes the order. בסוף גוף הלולאה, המתרגם קופץ חזרה לתחילת הלולאה.

This animation shows how the control flow moves in a `for` loop, and how the value of the loop counter changes on each *iteration*, or repetition of the loop body:

[[loop-py]]
.לולאת for, צעד אחרי צעד
[role="curriculum-python"]
[caption="Figure 4.2.1: "]
image::../media/U1P2/LoopPy_updated.gif[Alt Text]

.לולאת for, צעד אחרי צעד
[role="curriculum-javascript"]
[caption="Figure 4.2.1: "]
[[loop-js]]
image::../media/U1P2/LoopJS_updated.gif[Alt Text]

////
Although it is valid syntax, a `*monospace bold phrase*` causes a build error in AsciidocFX. Might be something to do with DocBook conversion. No bold for now. May see how ES handles it in the future.

BMW
////

One last interesting thing about `for` loops is incrementation.

[role="curriculum-python"]
Incrementation means increasing the counter's value. In `for` loops we used the `range()` function to increment the counter. We've seen two parameters for range: `startingNumber` and `endingNumber`. There is an optional third parameter: `increment`. By default, `increment` is equal to one, but you can use it to increment by more than one. For example, range(0, 10, 4) would increment by 4 between 0 and 10.

[role="curriculum-javascript"]
Incrementation means increasing the counter's value. In `for` loops we used the terms `measure = measure + 1`. This increments the counter `measure` by `1` for on each repeat. It's possible to increment it by more than one, like `measure = measure + 4`.

.תרגלו
****
לפני שתריצו את הקוד, נסו להסיק מה הוא עושה.
****

{nbsp} +

[role="curriculum-python"]
[source,python]
----
include::code-examples/loops-and-layers-incrementing.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/loops-and-layers-incrementing.js.txt[]
----

[role="curriculum-python"]
Here we used the `range()` function, but you can also increment (increase) or decrement (decrease) a variable using this type of expression: `measure = measure + 1`. משמעות הפעולה היא ש-measure שווה עכשיו לערכו הקודם ועוד אחד. You can use the shorthand `+=` to increment or `-=` to decrement. Here is how: `measure += 1` is equivalent to `measure = measure + 1`. And `measure -=1` is equivalent to `measure = measure - 1`

[role="curriculum-python"]
* `measure += 1` increments measure by 1. If you want to increment by more than one, use `measure += 2`.
* `measure -= 1` decrements measure by 1. If you want to decrement by more than one, use `measure -= 2`.

[role="curriculum-javascript"]
Here we wrote `measure = measure + 4`, which means measure is now equal to its former value plus four. You can use some shorthands:
 `+=` (or `-=` to decrement). הביטויים הבאים הם דרך קצרה להגדיל או להקטין את ערכו של המונה:

[role="curriculum-javascript"]
* `measure++`, or `measure += 1` increments measure by 1. If you want to increment by more than one, use `measure += 2`.
* `measure--`, or `measure -= 1` decrements measure by 1. If you want to decrement by more than one, use `measure -= 2`.

[[debuggingtips]]
=== טיפים לתיקון שגיאות (debugging)

תכנות הוא לא רק כתיבת קוד. It's also debugging and maintaining it. Debugging means finding and solving bugs. Bugs are another term for errors in your code. כשתתקלו בשגיאה, נסו את הצעדים הבאים:

[role="curriculum-python"]
. *Read the console for clues*.
. *Locate the error in your code:* You have three options here.
[role="curriculum-python"]
.. אם ההודעה בקונסול מציינת מספר שורה, יש לבדוק את השורה הזו ואת השורה שלפניה בקוד.
.. שימוש בהפיכת שורות להערות. You can narrow down an error by putting comment syntax around a block of code, or *commenting it out*, and running the code. אם ההרצה, כעת, נקייה משגיאות, אז השגיאה היא בחלק שהפך להערה.
.. *Print debugging* can also be used to locate an error. יש לקרוא את קטע הקוד בו נמצאת השגיאה ולעקוב אחרי אופן פעולתו. Insert `print()` calls where you are unsure of the logic, getting the value of variables and checking program state. ההדפסות מאפשרות להשוות השערות בדבר ערכי משתנים ואופן הפעולה, למה שהקוד מבצע בפועל.
. *Squash the bug:* Check for errors and edit the offending code, then run it to verify its correctness.
. *Ask for help:* If you find you have spent too much time on a bug, then ask someone for help! זוג עיניים רענן יכול לחולל פלאים!

[role="curriculum-javascript"]
. *Read the console for clues*.
. *Locate the error in your code:* You have three options here.
[role="curriculum-javascript"]
.. אם ההודעה בקונסול מציינת מספר שורה, יש לבדוק את השורה הזו ואת השורה שלפניה בקוד.
.. שימוש בהפיכת שורות להערות. You can narrow down an error by putting comment syntax around a block of code, or *commenting it out*, and running the code. אם ההרצה, כעת, נקייה משגיאות, אז השגיאה היא בחלק שהפך להערה.
.. *Print debugging* can also be used to locate an error. יש לקרוא את קטע הקוד בו נמצאת השגיאה ולעקוב אחרי אופן פעולתו. Insert `println()` calls where you are unsure of the logic, getting the value of variables and checking program state. ההדפסות מאפשרות להשוות השערות בדבר ערכי משתנים ואופן הפעולה, למה שהקוד מבצע בפועל.
. *Squash the bug:* Check for errors and edit the offending code, then run it to verify its correctness.
. *Ask for help:* If you find you have spent too much time on a bug, then ask someone for help! זוג עיניים רענן יכול לחולל פלאים!

קטע הווידאו מדגים, שלב אחרי שלב, תיקון שגיאות בעזרת הדפסת ערכי משתנים:

[role="curriculum-python curriculum-mp4"]
[[video15py]]
video::./videoMedia/015-02-TheDebuggingProcess-PY.mp4[]

[role="curriculum-javascript curriculum-mp4"]
[[video15js]]
video::./videoMedia/015-02-TheDebuggingProcess-JS.mp4[]

You've seen a list of potential errors in Chapter 1. להלן רשימה של שגיאות אפשריות נוספות:

[role="curriculum-python"]
. *Initializing variables*: A variable must be initialized before it can be used in a script. This means you should assign a value to your variable before using it later.
. *Comments:* Improper commenting will cause a <</en/v1/every-error-explained-in-detail#syntaxerror,syntax error>>. Python comments must start with a `#` symbol.
. *Indentation:* Indentation is critical in Python. Lack of indentation in `for` loop bodies will cause an <</en/v1/every-error-explained-in-detail#indentationerror,indentation error>>.
. *Quotations:* Forgetting an opening or closing quotation mark can also cause a <</en/v1/every-error-explained-in-detail#syntaxerror,syntax error>>.
. *Arguments:* Mistakes with function arguments can lead to all kinds of errors. חובה לספק מספר נכון של פרמטרים מהטיפוס הדרוש.

[role="curriculum-javascript"]
. *Initializing variables*: A variable must be initialized before it can be used in a script. This means you should create it with `var` before using it later.
. *Semicolons in for loop definition*: Semicolons must be used to separate the three parts (initialization, condition, and iteration statement) of a for loop definition.
. *Comments:* Improper commenting will cause a <</en/v1/every-error-explained-in-detail#syntaxerror,syntax error>>. JavaScript comments must start with `//`.
. *Quotations:* Forgetting an opening or closing quotation mark can also cause a <</en/v1/every-error-explained-in-detail#syntaxerror,syntax error>>.
. *Arguments:* Mistakes with function arguments can lead to all kinds of errors. חובה לספק מספר נכון של פרמטרים מהטיפוס הדרוש.

Take a look at <</en/v1/every-error-explained-in-detail#,Every Error Explained in Detail>> for a full description of different error types and what you can do to prevent them.

[[musicaltips]]
=== טיפים מוסיקליים

Now that you have many tools to create your music, like `fitMedia()`, `makeBeat()` and `for` loops, we will look at musical ideas.

Let's start with the *key* of your song:

* *Pitch* is how high or low a note sounds. We order relative musical tones on a *scale*, or set of musical notes, based on how we hear the frequency of the sound.
* The *key* of a song indicates the scale, or group of pitches, in which the music is composed. סולם (key) יכול להיות מז'ורי (בדרך כלל נשמע "שמח" יותר) או מינורי (בדרך כלל נשמע "עצוב" יותר).
* למלחינות מתחילות ולמלחינים מתחילים מומלץ להשתמש בסולם (key) אחד בשיר שלכם. Selecting sounds from different keys might sound... off-key! הקליפים באותה תיקייה בספריית הצלילים של EarSketch, הם כולם באותו סולם.

Listen to the audio clip below to hear the difference between major and minor keys (the major scale and chord is first):

++++
<div class="curriculum-mp3">audioMedia/MajorMinor.mp3</div>
++++

Now let's talk about the different types of tracks you can have. אפשר להשתמש בערוץ נפרד של ה-DAW לכל כלי בשיר. בשיר פופ, אפשר למצוא את הערוצים הבסיסיים הבאים:

* *Melody* is the main idea that's often higher pitched, or "the notes that the lead sings." It can be a voice, higher notes of a keyboard, guitar, etc.
* *Harmony* is the longer toned notes that "support the melody" like the chords on a piano, strumming guitar, or a collection of strings.
* You also have a *bass line*. ערוץ הבס מורכב מהצלילים הנמוכים יותר. It can be a bass, a cello, the lower notes of a keyboard, etc.
* Then there is *percussion*. If you're using `makeBeat()`, this can take several tracks. לדוגמה, יכול להיות ערוץ אחד לקיק (kick), ערוץ שני לסנר (snare) וערוץ שלישי להיי-האט (hi-hat).

These are basic ideas that create the structure of your song's texture. However, you can have some parts of your song that only contain one or two of the four. You can also add a lot more tracks: you can create a second melody, add drones (very long notes in the background), recorded sounds, whooshes, etc. The possibilities are endless! Explore ideas and keep the ones you like most!

Finally, let's discuss *repetition* and *contrast*. Humans enjoy repetition because of what psychologists call the _mere exposure effect_. כשהמוח שומע קטע מוסיקלי הוא מנסה לנחש מה יהיה התו הבא, מה שגורם למאזין/ה להרגיש שותפות בנגינה. כמו כן, בכל פעם שהקטע חוזר, המאזין/ה יכול/ה להבחין בפרטים נוספים ביצירה, כי המוח כבר לא צריך להתמקד בעיבוד החומר המלודי הגולמי.

קונטרסט מתייחס להבדלים בין קטעים עוקבים של מוסיקה, היוצרים איזון חשוב עם החזרה. קונטרסט משמש להבאת אלמנטים חדשים לתשומת לב המאזין/ה. קונטרסט יכול להיווצר בעזרת: שינויים ריתמיים, קווים מלודיים חדשים, הרמוניות חדשות או שינויים בכלים או בצלילים.

.תרגלו
****
צרו שיר בעזרת:

* נושא (ציינו את הנושא בהכרות בתחילת הקוד)
* The `fitMedia()` and `makeBeat()` functions
* One or more `for` loop(s) either with `fitMedia()` or `makeBeat()`
* At least four tracks
* At least sixteen measures
* לפחות קליפ אחד שהועלה לספריית הצלילים
* הערות ומשתנים לארגון הקוד

זכרו שאתם יכולים לנסות דברים שונים ולשמור רק את מה שנשמע טוב ומשרת את השיר. שתפו את המוסיקה שיצרתם!
****

{nbsp} +

[[chapter4summary]]
=== סיכום פרק רביעי

[role="curriculum-python"]
* A *`for` loop* instructs the computer to execute a code section repeatedly, requiring less code. `for` loops consist of a loop body, loop counter, and range. הקוד בגוף הלולאה חייב להיות מוזח ימינה.
* The *control flow* represents the order in which statements are executed by the computer.
* `print()` displays the data in the console. זה כלי שימושי לתיקון שגיאות (debugging) כי הוא מאפשר ללמוד על מצב התכנית וערכי המשתנים.
* הדפסה, הפיכת שורות קוד להערות והקונסול יכולים לעזור בתיקון שגיאות. בנוסף, בקשת עזרה יכולה לזרז את תהליך תיקון השגיאות.
* Revisit the expanded list of common programming errors: <<debugging-and-documenting#commonerrors,Common Errors>>.
* The *pitch* of a sound determines how high or low it sounds on a relative scale.
* The *key* of a song defines the *scale*, or group of pitches, in which the piece is composed, as well as the *tonic* note. סולמות (keys) הם מז'וריים או מינוריים, דבר שמשרה על המאזין/ה הלכי רוח שונים.
* אפשר להשתמש בשלושה ערוצים כשלד של השיר: מלודיה (בצלילים גבוהים יחסית) בס (בצלילים נמוכים יחסית) וכלי הקשה.

[role="curriculum-javascript"]
* A *`for` loop* instructs the computer to execute a code section repeatedly, requiring less code. `for` loops consist of a loop body, initialization, iteration statement, and loop condition. הקוד בגוף הלולאה צריך להיות מוזח ימינה.
* The *control flow* represents the order in which statements are executed by the computer.
* `println()` displays the data in the console. זה כלי שימושי לתיקון שגיאות (debugging) כי הוא מאפשר ללמוד על מצב התכנית וערכי המשתנים.
* הדפסה, הפיכת שורות קוד להערות והקונסול יכולים לעזור בתיקון שגיאות. בנוסף, בקשת עזרה יכולה לזרז את תהליך תיקון השגיאות.
* Revisit the expanded list of common programming errors: <<debugging-and-documenting#commonerrors,Common Errors>>.
* The *pitch* of a sound determines how high or low it sounds on a relative scale.
* The *key* of a song defines the *scale*, or group of pitches, in which the piece is composed, as well as the *tonic* note. סולמות (keys) הם מז'וריים או מינוריים, דבר שמשרה על המאזין/ה הלכי רוח שונים.
* You can use three basic tracks for the backbone of your songs: higher pitched melody, lower pitched bass, and percussion.

[[chapter-questions]]
=== שאלות

[question]
--
Which of the following is NOT a component of a `for` loop?

[answers]
* מתרגם הלולאה
* מונה הלולאה
* גוף הלולאה
* טווח (range) הלולאה
--

[question]
--
מי מהמשפטים הבאים אינו מתאר שימוש מוצלח של לולאות ביצירה מוסיקלית?

[answers]
* יצירת תבנית ביטים שאינה חוזרת על עצמה
* מיקום קליפ בכל תיבה שלישית
* חזרה על ביט במספר תיבות סמוכות
* מיקום קליפים בתיבות אי-זוגיות
--

[question]
--
מי מהמשפטים הבאים לא מתאר טכניקה מומלצת לתיקון שגיאות?

[answers]
* העתקה והדבקה של קטעי קוד במנוע החיפוש של Google
* הדפסת ערכי משתנים לקונסול
* בדיקת שורות שגויות שמספרן מצוין בקונסול
* בקשת עזרה מחבר/ה
--

[question]
--
מי מהבאים לא יכול להיות מודפס בקונסול?

[answers]
* הערות בקוד
* מחרוזות (Strings)
* ביטויים מתמטיים
* משתנים
--

[question]
--
____ is a quality of sound that determines how high or low it sounds.

[answers]
* גובה (pitch)
* טמפו
* מקצב
* עוצמה
--