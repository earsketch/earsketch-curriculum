[[effectsandenvelopes]]
== Effets et enveloppes

:nofooter:

EarSketch lets the composer alter existing sounds to produce new and unique sounds. This is achieved through the `setEffect()` function, the focus of this chapter.

[[effectsinearsketch]]
=== Use Effects in EarSketch

:nofooter:

*Effects* allow us to change qualities of sounds. Tout comme ajouter un filtre permet de modifier une photo, ajouter un effet permet de modifier un son. For example, you can change the volume, add some echo or reverb, etc.

[role="curriculum-python curriculum-mp4"]
[[video4py]]
video::./videoMedia/004-01-UsingEffectsinEarSketch-PY.mp4[]

[role="curriculum-javascript curriculum-mp4"]
[[video4js]]
video::./videoMedia/004-01-UsingEffectsinEarSketch-JS.mp4[]

We use the function `setEffect()`, which takes four arguments, similar to `fitMedia()`:

. *track*: Track number or `MIX_TRACK`
. *type*: Effect constant, like `DELAY`
. *parameter*: Parameter constant, like `DELAY_TIME`
. *value*: Parameter value, like `200`. This value must be within the effect's range.

.ENTRAÎNEZ-VOUS
****
Write a new song with two tracks and modify the volume for both of the tracks using the `setEffect()` function.
In that case, the effect name (second argument) is `VOLUME`, and the effect parameter (third argument) is `GAIN`. The effect value (fourth argument) is a number of decibels (dB), between `-60` and `+12`.
****

Voyez l'exemple ci-dessous :

[role="curriculum-python"]
[source,python]
----
include::code-examples/effects-and-envelopes-volume-effect.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/effects-and-envelopes-volume-effect.js.txt[]
----

We've seen the `VOLUME` effect. Let's now look at `DELAY`. Listen to the 2 clips below, one without and one with a *delay* effect applied.

Aucun effet :

++++
<div class="curriculum-mp3">audioMedia/reference.mp3</div>
++++

Effet de délai :

++++
<div class="curriculum-mp3">audioMedia/delay2.mp3</div>
++++

In that case, the effect name (second argument) is `DELAY`, and the effect parameter (third argument) can either be `DELAY_TIME` (how long before the echo "answers") or `DELAY_FEEDBACK` (how loud your echo is). The value of `DELAY_TIME` is in milliseconds (1000 milliseconds is one second) and the value of `DELAY_FEEDBACK` is a number between `-120` and `-1`.

For example, `setEffect(1, DELAY, DELAY_TIME, 500)` puts a delay onto track 1 with the delay/echo lasting for 500 ms.

.ENTRAÎNEZ-VOUS
****
. Read about the delay effect in the list of effects chapter here: <</en/v1/every-effect-explained-in-detail#,effects>>
. Exécutez ensuite le code ci-dessous et écoutez la musique sans les effets.
. Then uncomment the first `setEffect()` line and listen to the difference
. Then uncomment the second `setEffect()` line and listen to the difference ("uncomment" means to erase the comment syntax, `#` or `//` from a block of code)
Note that the delay time, 500ms, is the length of one beat. Comme le tempo correspond à 120 battements par minute, il y a un battement tous les 60/120 = 1/2 seconde. 1 seconde correspond à 1000 ms, donc 1/2 seconde correspond à 1000/2 = 500 ms.
Vous pouvez essayer de modifier le délai et d'évaluer si votre musique sonne mieux ou pas.
****

{nbsp} +

[role="curriculum-python"]
[source,python]
----
include::code-examples/effects-and-envelopes-delay-effect.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/effects-and-envelopes-delay-effect.js.txt[]
----

{nbsp} +

[[functionsandmoreeffects]]
=== Fonctions et autres effets

So far, you've been using several functions in EarSketch like `fitMedia()` or `setEffect()`. Notez que les noms des fonctions commencent toujours par une lettre minuscule et sont souvent un verbe. The parentheses tell the computer to *call*, or *execute*, the function. *Arguments*, or parameters, between the parentheses are separated by commas.

[role="curriculum-python"]
* `setTempo()`, `fitMedia()`, `makeBeat()`, and now `setEffect()` take arguments. They are part of the EarSketch *Application Programming Interface*, or *API*. EarSketch, ou l'API EarSketch, ajoute des fonctionnalités musicales à Python. Un autre exemple d'API est l'API de Google Maps : un ensemble d'outils pour intégrer des cartes dans des sites Web ou des applications.
* In a later chapter, you'll also learn how to create your own custom functions.

[role="curriculum-javascript"]
* `setTempo()`, `fitMedia()`, `makeBeat()`, and now `setEffect()` take arguments. They are part of the EarSketch *Application Programming Interface*, or *API*. EarSketch, ou l'API de EarSketch, ajoute des fonctionnalités musicales à JavaScript. Un autre exemple d'API est l'API de Google Maps : un ensemble d'outils pour intégrer des cartes dans des sites Web ou des applications.
* In a later chapter, you'll also learn how to create your own custom functions.

Chacun des arguments de la fonction peut avoir un type de données spécifique. L'ordre des arguments est également important. Voyez ci-dessous quelques exemples de type de données :

* *Numbers*
** *Integers* are whole numbers, like 0, 5, or -26. Example: track numbers
** *Floating point* numbers are rational numbers like 0.125 or -21.0. Example: volume of -4.2dB
* *Strings* represent text. Example: `"0000----0000----"`

Now, let's play more with the `setEffect()` function. La vidéo suivante montre comment utiliser certains effets :

////
VIDEO IS BEEING MADE
more info here: https://docs.google.com/spreadsheets/d/114pWGd27OkNC37ZRCZDIvoNPuwGLcO8KM5Z_sTjpn0M/edit#gid=302140020
("videos revamping" tab)
////

*Reverb* (short for reverberation) is sound bouncing off walls and returning to your ears. Cela donne un sens de l'espace à votre son. Pensez à la différence entre le fait de parler dans une petite chambre et parler dans une grande église. Plus la pièce est grande, plus les ondes mettent de temps à revenir vers vos oreilles, d'où ce son d'« écho de grande pièce ». The `REVERB` effect has parameters to control the decay time (`REVERB_DECAY`) and amount of the effect present (`MIX`).

Écoutez les clips ci-dessous pour découvrir le résultat de l'ajout de réverbération à une piste :

Aucun effet :

++++
<div class="curriculum-mp3">audioMedia/reverbReference.mp3</div>
++++

Effet de réverbération :

++++
<div class="curriculum-mp3">audioMedia/reverbEffect.mp3</div>
++++

{nbsp} +

.ENTRAÎNEZ-VOUS
****
Go to <</en/v1/every-effect-explained-in-detail#,this chapter>> for a complete list of effects.
Create a song with a volume effect and two other effects. Don't forget to write what you are doing in the comments and to create variables when necessary.
****

[[effectsandenvelopes2]]
=== Effets et enveloppes

You've started using effects, and maybe you'd like for one effect to change over time. For example, you might want a fade in (volume getting higher) at the beginning of your song.

*Envelopes* allow us to define how an effect changes over time.

We will use two value-time pairs. Chaque paire contient une valeur d'effet et une mesure correspondante. For example, `(-60, 1, 0, 3)` means a point is placed at value `-60` at measure `1`, and another point is placed at value `0` at measure `3`. The envelope creates a line between these points, called a *ramp*:

[[envelopepoints]]
.Une enveloppe annotée dans EarSketch
[caption="Figure 5.3.1: "]
image::../media/U2/NewEnvelope.png[Alt Text]

To change an envelope, you just need the `setEffect()` function with seven arguments (the last four arguments are the two value-time pairs):

. track
. type
. parameter
. startValue
. start
. endValue
. end

The last three out of seven parameters are *optional parameters*. If left unspecified, as was the case when we used `setEffect()` with only four parameters, the effect is applied to the entire track.

Voici un exemple de fondu d'ouverture :

[role="curriculum-python"]
[source,python]
----
include::code-examples/effects-and-envelopes-envelopes.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/effects-and-envelopes-envelopes.js.txt[]
----

Maintenant, visualisez la vidéo suivante pour voir d'autres exemples d'enveloppes

[role="curriculum-python curriculum-mp4"]
[[video5b]]
video::./videoMedia/005-03-MoreEffectsB-PY.mp4[]

[role="curriculum-python"]
[source,python]
----
include::code-examples/effects-and-envelopes-complex-envelopes.py.txt[]
----

[role="curriculum-javascript curriculum-mp4"]
video::./videoMedia/005-03-MoreEffectsB-JS.mp4[]

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/effects-and-envelopes-complex-envelopes.js.txt[]
----

{nbsp} +

.ENTRAÎNEZ-VOUS
****
Créez une nouvelle chanson. Use one `for` loop to add an envelope to all the tracks (for example: fade in and fade out for all your tracks), or to repeat an effect on the same track. Il vous est possible d'utiliser n'importe quel effet de votre choix.
Faites ensuite écouter votre chanson avec et sans effet à votre voisin.e (pour écouter votre chanson sans effet, veuillez commenter les lignes qui créent l'effet). Votre voisin.e doit deviner quel effet vous avez ajouté.
****

Below is an example of the above practice. Chaque itération de la boucle ajoute un segment (durée du segment : une mesure) de l'enveloppe. Automating the GAIN parameter creates rhythmic volume fades. Essayez d'activer le contournement des effets dans le DAW pour entendre la différence que fait l'ajout d'effet (le bouton « bypass » à gauche de la piste d'effet dans votre DAW).

[role="curriculum-python"]
[source,python]
----
include::code-examples/effects-and-envelopes-rhythmic-ramps.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/effects-and-envelopes-rhythmic-ramps.js.txt[]
----

Et voici un exemple de fondus d'ouverture et de fermeture sur toutes les pistes :

[role="curriculum-python"]
[source,python]
----
include::code-examples/effects-and-envelopes-fade-in-and-fade-out.py.txt[]
----

[role="curriculum-javascript"]
[source,javascript]
----
include::code-examples/effects-and-envelopes-fade-in-and-fade-out.js.txt[]
----

{nbsp} +

[[chapter5summary]]
=== Résumé du chapitre 5

* *Effects* change the qualities of a sound to make them unique.
* *Volume* is related to loudness. *Delay* creates an echo. *Reverb* makes it feel like the sound is played in a large room. *Panning* places your music on the left or right side.
* Effects are implemented in EarSketch with the `setEffect()` function. Its syntax is `setEffect(track, type, parameter, value)`.
. *track*: Track number or `MIX_TRACK`
. *type*: Effect constant, like `DELAY`
. *parameter*: Parameter constant, like `DELAY_TIME`
. *value*: Parameter value, like `200`. This value must be within the effect's range.
* *Functions* contain instructions for the computer to execute. Data is sent to functions by *arguments*, which affect how the function executes. The syntax of a function *call* with two arguments is `myFunction(argument1, argument2)`. An example of syntax used in a function *call* with 4 arguments is `makeBeat(kick, 2, measure, kickBeat)`.
* A complete list of EarSketch effects and their parameters can be found in <</en/v1/every-effect-explained-in-detail#,effects>>, along with descriptions for each.
* *Envelopes* define how an effect parameter changes over time. They are described with value-time pairs, like _(value, time, value, time)_.
* For an envelope, the 7-parameter `setEffect()` arguments are: `setEffect(track, type, parameter, startValue, start, endValue, end)`.

[[chapter-questions]]
=== Questions

[question]
--
Qu'est-ce qu'un effet vous permet de faire dans EarSketch ?

[answers]
* Modifier les qualités sonores d'un projet
* Ajouter un son à une piste
* Créer un rythme percussif
* Modifier le tempo d'une chanson
--

[question]
--
Which of these is NOT a `setEffect()` argument?

[answers]
* Nom de clip
* Nom de l'effet
* Valeur de l'effet
* Numéro de piste
--

[question]
--
Comment régleriez-vous le délai d'un effet de délai sur la piste 3 à 50 millisecondes ?

[answers]
* `setEffect(3, DELAY, DELAY_TIME, 50.0)`
* `setEffect(DELAY, 3, DELAY_TIME, 50.0)`
* `fitMedia(DELAY, 3, DELAY_TIME, 50.0)`
* `setEffect(50, DELAY_FEEDBACK, 1)`
--

[question]
--
Which of the following is not a parameter used with `setEffect()` envelopes?

[answers]
* Longueur du clip
* Valeur de départ
* Numéro de piste
* Effet
--

[question]
--
What would the following `setEffect()` function do?

[source,python]
----
setEffect(1, DISTORTION, DISTO_GAIN, 0, 1, 50, 11)
----

[answers]
* Augmenter la quantité de distorsion sur la piste 1 pendant 10 mesures.
* Diminuer la quantité de distorsion sur la piste 1 pendant 50 mesures.
* Augmenter le volume de la piste 1 sur 10 mesures.
* Diminuer le volume sur la piste 1 sur 50 mesures.
--